
{% load static %}
<!doctype html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="대한민국 대표 지식 공유 커뮤니티 - PyBo">
    <meta name="keywords" content="질문답변, 커뮤니티, 지식공유, 개발자">
    <meta name="author" content="PyBo Community">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="PyBo - 지식을 나누는 커뮤니티">
    <meta property="og:description" content="개발자들을 위한 최고의 Q&A 플랫폼">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Custom CSS (분리된 토큰/테마/컴포넌트) -->
    <link rel="stylesheet" href="{% static 'css/variables.css' %}">
    <link rel="stylesheet" href="{% static 'css/themes.css' %}">
    <link rel="stylesheet" href="{% static 'style.css' %}">
    
    <title>{% block title %}PyBo - 지식을 나누는 커뮤니티{% endblock %}</title>
</head>
    <body class="{{ theme_class|default:'theme-light' }}" data-theme-default="light">
<!-- 네비게이션바 -->
{% include "navbar.html" %}
<!-- 기본 템플릿 안에 삽입될 내용 Start -->
{% block content %}
{% endblock %}
<!-- 기본 템플릿 안에 삽입될 내용 End -->
            <!-- Theme Toggle Script -->
                        <script>
                        (function(){
                            const KEY='site-theme';
                            const body=document.body;
                            const IS_AUTH = "{{ user.is_authenticated|yesno:'true,false' }}" === 'true';
                            function apply(theme){
                                body.classList.remove('theme-light','theme-dark','theme-highcontrast');
                                body.classList.add('theme-'+theme);
                            }
                            function getCookie(name){
                                const v=document.cookie.match('(^|;)\\s*'+name+'=([^;]+)');
                                return v?decodeURIComponent(v.pop()):'';
                            }
                            function getCsrf(){
                                return getCookie('csrftoken');
                            }
                            const saved=localStorage.getItem(KEY) || getCookie('site_theme');
                            if(saved) {
                                console.log('Applying saved theme:', saved);
                                apply(saved);
                            } else {
                                console.log('No saved theme, using default light');
                            }
                            window.setTheme=function(theme){
                                console.log('Setting theme to:', theme);
                                apply(theme);
                                localStorage.setItem(KEY,theme);
                                document.cookie = 'site_theme='+theme+';path=/;max-age='+(3600*24*365);
                                console.log('Theme applied, current body classes:', body.className);
                                if(IS_AUTH){
                                    fetch('{% url "common:save_theme" %}',{
                                        method:'POST',
                                        headers:{'X-CSRFToken': getCsrf(),'Accept':'application/json','Content-Type':'application/x-www-form-urlencoded'},
                                        body:new URLSearchParams({theme})
                                    }).then(r=>r.json()).then(d=>{
                                        if(d.status!=='ok') console.warn('Theme save error',d);
                                        else console.log('Theme saved successfully:', d);
                                    }).catch(e=>console.error('Theme save failed',e));
                                }
                            };
                        })();
                        </script>
 <!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Back to Top Button -->
<button id="backToTop" class="btn btn-primary" style="display: none; position: fixed; bottom: 20px; right: 20px; z-index: 1000; border-radius: 50%; width: 50px; height: 50px;">
    <i class="fas fa-arrow-up"></i>
</button>

<!-- Global JavaScript -->
<script>
// Back to Top 기능
document.addEventListener('DOMContentLoaded', function() {
    const backToTopButton = document.getElementById('backToTop');
    
    window.addEventListener('scroll', function() {
        if (window.pageYOffset > 300) {
            backToTopButton.style.display = 'block';
        } else {
            backToTopButton.style.display = 'none';
        }
    });
    
    backToTopButton.addEventListener('click', function() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });

    // 툴팁 초기화
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    // 토스트 초기화
    const toastElList = [].slice.call(document.querySelectorAll('.toast'));
    toastElList.map(function (toastEl) {
        return new bootstrap.Toast(toastEl);
    });
});

// 전역 알림 함수
function showAlert(message, type = 'info') {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
    alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    document.body.appendChild(alertDiv);
    
    // 5초 후 자동 제거
    setTimeout(() => {
        if (alertDiv.parentNode) {
            alertDiv.remove();
        }
    }, 5000);
}
</script>

<!-- 페이지별 스크립트 -->
{% block script %}
{% endblock %}

</body>
</html>
